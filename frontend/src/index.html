<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vapi AI Assistant</title>
    <style>
        body, html {
            height: 100%;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #vapi-container {
            width: 200px;
            height: 50px;
        }
    </style>
</head>
<body>
    <div id="vapi-container"></div>

    <script>
      const assistant = "f40147e8-31f4-42d2-834b-5d44789d38ca"; // Replace with your assistant ID
      const apiKey = "2c1402e4-e88b-4057-9cbc-c9759296a052"; // Replace with your API key
  
      var vapiInstance = null;
  
      const buttonConfig = {
        position: "custom",
        container: "vapi-container",
        width: "200px",
        height: "50px",
        zIndex: 2147483647,
        idle: {
          // ... existing idle config ...
        },
        loading: {
          // ... existing loading config ...
        },
        active: {
          // ... existing active config ...
        },
      };
  
      (function (d, t) {
        var g = document.createElement(t),
          s = d.getElementsByTagName(t)[0];
        g.src =
          "https://cdn.jsdelivr.net/gh/VapiAI/html-script-tag@1.1.6/dist/assets/index.js";
        // g.src = './src/index.js'
        // g.type = "module";
        g.defer = true;
        g.async = true;
        s.parentNode.insertBefore(g, s);
  
        g.onload = function () {
          const vapi = window.vapiSDK.run({
            apiKey: apiKey, // required
            // squad: 'e49a15d9-f6dc-4010-a05a-611adbfb3aaa', 
            assistant: assistant, // required
            config: buttonConfig, // optional
          });
  
          if (vapi) {
            // Extend more using vapi
            window.vapiSDK.vapi = vapi;
            vapiInstance = vapi;
  
            vapiInstance.on("speech-start", () => {
              console.log("Speech has started");
            });
  
            vapiInstance.on("speech-end", () => {
              console.log("Speech has ended");
            });
  
            vapiInstance.on("call-start", () => {
              console.log("Call has started");
            });
  
            vapiInstance.on("call-end", () => {
              console.log("Call has stopped");
            });
  
            vapiInstance.on("volume-level", (volume) => {
              console.log(`Assistant volume level: ${volume}`);
            });
  
            // Function calls and transcripts will be sent via messages
            vapiInstance.on("message", (message) => {
              console.log(message);
            });
  
            vapiInstance.on("error", (e) => {
              console.error(e);
            });
          }
        };
      })(document, "script");
  
      function logUserAction() {
        // Function to log the user action
  
        if (window.vapiSDK.vapi)
          window.vapiSDK.vapi.send({
            type: "add-message",
            message: {
              role: "system",
              content: "The user has pressed the button, say peanuts",
            },
          });
        else {
          console.log(window.vapiSDK, vapiInstance);
        }
      }
    </script>
</body>
</html>